I"ë<p>Code from <a href="http://pastebin.ubuntu.com/8803153/">http://pastebin.ubuntu.com/8803153/</a></p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="nf">Dim</span><span class="w"> </span><span class="nx">s</span><span class="w">
</span><span class="nf">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">InputBox</span><span class="p">(</span><span class="s2">"å½“å‰Windowsç³»ç»Ÿåºåˆ—å·ä¸ºï¼š"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Windowsåºåˆ—å·"</span><span class="p">,</span><span class="w"> </span><span class="nf">GetWindowsSN</span><span class="p">)</span><span class="w">
</span><span class="nf">WScript.Quit</span><span class="w">


</span><span class="s1">'å–å¾—å½“å‰Windowsåºåˆ—å·å‡½æ•°

Function GetWindowsSN()
    Const HKEY_LOCAL_MACHINE = &amp;H80000002
    strKeyPath = "SOFTWARE\Microsoft\Windows NT\CurrentVersion"
    strValueName = "DigitalProductId"
    strComputer = "."
    Dim iValues()
    Set oReg = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" &amp; strComputer &amp; "\root\default:StdRegProv")
    oReg.GetBinaryValue HKEY_LOCAL_MACHINE, strKeyPath, strValueName, iValues
    Dim arrDPID
    arrDPID = Array()
    For i = 52 To 66
        ReDim Preserve arrDPID( UBound(arrDPID) + 1 )
        arrDPID( UBound(arrDPID) ) = iValues(i)
    Next
    '</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">---------------</span><span class="w"> </span><span class="nx">Create</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">array</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">hold</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">characters</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">microsoft</span><span class="w"> </span><span class="nx">Product</span><span class="w"> </span><span class="nx">Key</span><span class="w"> </span><span class="nf">--------------------------</span><span class="err">&gt;</span><span class="w">
    </span><span class="nx">Dim</span><span class="w"> </span><span class="nx">arrChars</span><span class="w">
    </span><span class="nf">arrChars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Array</span><span class="p">(</span><span class="s2">"B"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C"</span><span class="p">,</span><span class="w"> </span><span class="s2">"D"</span><span class="p">,</span><span class="w"> </span><span class="s2">"F"</span><span class="p">,</span><span class="w"> </span><span class="s2">"G"</span><span class="p">,</span><span class="w"> </span><span class="s2">"H"</span><span class="p">,</span><span class="w"> </span><span class="s2">"J"</span><span class="p">,</span><span class="w"> </span><span class="s2">"K"</span><span class="p">,</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w"> </span><span class="s2">"P"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Q"</span><span class="p">,</span><span class="w"> </span><span class="s2">"R"</span><span class="p">,</span><span class="w"> </span><span class="s2">"T"</span><span class="p">,</span><span class="w"> </span><span class="s2">"V"</span><span class="p">,</span><span class="w"> </span><span class="s2">"W"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w"> </span><span class="s2">"7"</span><span class="p">,</span><span class="w"> </span><span class="s2">"8"</span><span class="p">,</span><span class="w"> </span><span class="s2">"9"</span><span class="p">)</span><span class="w">

    </span><span class="s1">' &lt;--------------- The clever bit !!! (Decrypt the base24 encoded binary data)--------------------------&gt;
    For i = 24 To 0 Step -1
        k = 0
        For j = 14 To 0 Step -1
            k = k * 256 Xor arrDPID(j)
            arrDPID(j) = Int(k / 24)
            k = k Mod 24
        Next
        strProductKey = arrChars(k) &amp; strProductKey
        '</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">-------</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="s2">"-"</span><span class="w"> </span><span class="nx">between</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">groups</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">5</span><span class="w"> </span><span class="nx">Char</span><span class="w"> </span><span class="nf">--------</span><span class="err">&gt;</span><span class="w">
        </span><span class="nx">If</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="nx">Mod</span><span class="w"> </span><span class="nx">5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">And</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="err">&lt;&gt;</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">Then</span><span class="w"> </span><span class="nx">strProductKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"-"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nf">strProductKey</span><span class="w">
    </span><span class="nf">Next</span><span class="w">
    </span><span class="nf">GetWindowsSN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">strProductKey</span><span class="w">
</span><span class="kr">End</span><span class="w"> </span><span class="kr">Function</span></code></pre></figure>
:ET